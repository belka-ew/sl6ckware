#!/bin/execlineb -P

################################################
# Start the Network Time Protocol (NTP) daemon #
################################################

foreground { echo "Starting longrun service:  ntpd" }
backtick -ni NTPD { which ntpd }
# Using ntp-wait to wait for ntpd to stabilize the system clock
# and then write an output to notification fd
background {
  fdmove 1 3
  ntp-wait -v
}
fdclose 3
importas -u ntpd NTPD
foreground { echo "Starting NTP daemon:  ${ntpd} -g -u ntp:ntp" }
emptyenv $ntpd -g -u ntp:ntp
