#!/bin/execlineb -P

################################
# Start crond (Dillon's crond) #
################################

fdmove -c 2 1
backtick -ni CROND { which crond }
if { mkdir -p /var/run/cron }
# Using /var/run/cron/cron-* appearance as readiness indicator
background -d {
  fdmove 1 3
  inotifywait -qe attrib /var/run/cron
}
fdclose 3
# Read crond commandline arguments from /etc/default/crond
envfile /etc/default/crond
multisubstitute {
  importas -usd" " crond_opts CROND_OPTS
  importas -u crond CROND
}
foreground { echo "crond: Starting crond: ${crond} -f" $crond_opts }
exec -c $crond -f $crond_opts
