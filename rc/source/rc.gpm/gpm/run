#!/bin/execlineb -P

##############################
# Start the GPM mouse server #
##############################

fdmove -c 2 1
# Using the same gpm command as the one used in /etc/rc.d/rc.gpm
backtick -ni GPM { sed -n "/Starting gpm:/ s/\"//g; s/.*gpm:\\s*//p" /etc/rc.d/rc.gpm }
importas -usd" " gpm GPM
# Added "-D" command line option to prevent gpm from backgrounding
foreground { echo "gpm: Starting gpm:" $gpm -D }
# Using gpmctl availability as readiness indicator
s6-notifyoncheck -dc "[ -S /dev/gpmctl ]"
exec -c $gpm -D
