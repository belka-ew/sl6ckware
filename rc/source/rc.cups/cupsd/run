#!/bin/execlineb -P

########################################
# Start the CUPS print spooling system #
########################################

fdmove -c 2 1
backtick -ni CUPSD { which cupsd }
if { mkdir -p /var/run/cups }
# Using cups.sock appearance as readiness indicator
background {
  fdmove 1 3
  inotifywait -qe attrib --include cups.sock /var/run/cups
}
fdclose 3
importas -u cupsd CUPSD
foreground { echo "cupsd: Starting cupsd: ${cupsd} -f" }
emptyenv $cupsd -f
